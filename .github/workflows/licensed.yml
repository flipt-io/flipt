name: Licensed
on:
  workflow_dispatch:
  pull_request_target:
    types: [labeled]
    paths-ignore:
      - '*.md'
      - '.all-contributorsrc'

jobs:
  licensed:
    runs-on: ubuntu-latest
    if: contains(github.event.pull_request.labels.*.name, 'dependencies')
    steps:
    - uses: actions/checkout@v2

    - uses: actions/setup-go@v1
      with:
        go-version: '1.15.x'

    - uses: jonabc/setup-licensed@v1
      with:
        version: 2.x
        
    - uses: jonabc/licensed-ci@v1
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}