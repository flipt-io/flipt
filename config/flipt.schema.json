{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$ref": "#/definitions/FliptConfig",
  "definitions": {
    "FliptConfig": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "authentication": {
          "$ref": "#/definitions/authentication"
        },
        "cache": {
          "$ref": "#/definitions/cache"
        },
        "cors": {
          "$ref": "#/definitions/cors"
        },
        "database": {
          "$ref": "#/definitions/database"
        },
        "log": {
          "$ref": "#/definitions/log"
        },
        "meta": {
          "$ref": "#/definitions/meta"
        },
        "server": {
          "$ref": "#/definitions/server"
        },
        "tracing": {
          "$ref": "#/definitions/tracing"
        },
        "ui": {
          "$ref": "#/definitions/ui"
        }
      },
      "required": [],
      "title": "Flipt Config"
    },
    "authentication": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "required": {
          "type": "boolean",
          "default": false
        },
        "methods": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "token": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": false
                },
                "cleanup": {
                  "$ref": "authentication-cleanup"
                }
              },
              "required": [],
              "title": "Token"
            }
          },
          "required": [],
          "title": "Methods"
        }
      },
      "required": [],
      "title": "Authentication",
      "definitions": {
        "cleanup": {
          "$id": "authentication-cleanup",
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "interval": {
              "anyOf": [
                {
                  "type": "string",
                  "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
                },
                {
                  "type": "integer"
                }
              ],
              "default": "1h"
            },
            "gracePeriod": {
              "anyOf": [
                {
                  "type": "string",
                  "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
                },
                {
                  "type": "integer"
                }
              ],
              "default": "30m"
            }
          },
          "required": [],
          "title": "Cleanup"
        }
      }
    },
    "cache": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "backend": {
          "type": "string",
          "enum": ["memory", "redis"],
          "default": "memory"
        },
        "ttl": {
          "anyOf": [
            {
              "type": "string",
              "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
            },
            {
              "type": "integer"
            }
          ],
          "default": "60s"
        },
        "redis": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "host": {
              "type": "string",
              "default": "localhost"
            },
            "port": {
              "type": "integer",
              "default": 6379
            },
            "db": {
              "type": "integer",
              "default": 0
            },
            "password": {
              "type": "string"
            }
          },
          "required": [],
          "title": "Redis"
        },
        "memory": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "evictionInterval": {
              "anyOf": [
                {
                  "type": "string",
                  "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
                },
                {
                  "type": "integer"
                }
              ],
              "default": "5m"
            }
          },
          "required": [],
          "title": "Memory"
        }
      },
      "required": [],
      "title": "Cache"
    },
    "cors": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false
        },
        "allowedOrigins": {
          "type": "array",
          "default": ["*"]
        }
      },
      "required": [],
      "title": "Cors"
    },
    "database": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "url": {
          "type": "string",
          "default": "file:/var/opt/flipt/flipt.db"
        },
        "protocol": {
          "type": "string",
          "enum": [
            "cockroach",
            "cockroachdb",
            "file",
            "mysql",
            "postgres",
            "sqlite"
          ]
        },
        "host": {
          "type": "string"
        },
        "port": {
          "type": "integer"
        },
        "name": {
          "type": "string"
        },
        "user": {
          "type": "string"
        },
        "password": {
          "type": "string"
        },
        "maxIdleConn": {
          "type": "integer",
          "default": 2
        },
        "maxOpenConn": {
          "type": "integer"
        },
        "connMaxLifetime": {
          "type": "integer"
        }
      },
      "required": [],
      "title": "DB"
    },
    "log": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "file": {
          "type": "string"
        },
        "encoding": {
          "type": "string",
          "enum": ["json", "console"],
          "default": "console"
        },
        "level": { "$ref": "log-level" },
        "grpcLevel": { "$ref": "log-level" }
      },
      "required": [],
      "title": "Log",
      "definitions": {
        "level": {
          "$id": "log-level",
          "type": "string",
          "enum": [
            "debug",
            "DEBUG",
            "error",
            "ERROR",
            "fatal",
            "FATAL",
            "info",
            "INFO",
            "PANIC",
            "panic",
            "trace",
            "TRACE",
            "warn",
            "WARN"
          ]
        }
      }
    },
    "meta": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "checkForUpdates": {
          "type": "boolean",
          "default": true
        },
        "telemetryEnabled": {
          "type": "boolean",
          "default": true
        },
        "stateDirectory": {
          "type": "string",
          "default": "$HOME/.config/flipt"
        }
      },
      "required": [],
      "title": "Meta"
    },
    "server": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "protocol": {
          "type": "string",
          "enum": ["http", "https"],
          "default": "http"
        },
        "host": {
          "type": "string",
          "default": "0.0.0.0"
        },
        "httpsPort": {
          "type": "integer",
          "default": 443
        },
        "httpPort": {
          "type": "integer",
          "default": 8080
        },
        "grpcPort": {
          "type": "integer",
          "default": 9000
        },
        "certFile": {
          "type": "string"
        },
        "certKey": {
          "type": "string"
        }
      },
      "required": [],
      "title": "Server"
    },
    "tracing": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "jaeger": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            },
            "host": {
              "type": "string",
              "default": "localhost"
            },
            "port": {
              "type": "integer",
              "default": 6831
            }
          },
          "title": "Jaeger"
        }
      },
      "title": "Tracing"
    },
    "ui": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        }
      },
      "title": "UI"
    }
  }
}
